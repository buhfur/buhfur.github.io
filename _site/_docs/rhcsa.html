<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(22)) > a, .site-nav > ul.nav-list:first-child > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(22) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(22) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(22) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Notes about RHCSA | Buhfur’s Wiki</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Notes about RHCSA" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="The wiki for all things linux / IT / Tech related." /> <meta property="og:description" content="The wiki for all things linux / IT / Tech related." /> <link rel="canonical" href="http://localhost:4000/_docs/rhcsa.html" /> <meta property="og:url" content="http://localhost:4000/_docs/rhcsa.html" /> <meta property="og:site_name" content="Buhfur’s Wiki" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Notes about RHCSA" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"The wiki for all things linux / IT / Tech related.","headline":"Notes about RHCSA","url":"http://localhost:4000/_docs/rhcsa.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Buhfur's Wiki </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/_docs/linux.html" class="nav-list-link">Linux</a></li><li class="nav-list-item"><a href="/_docs/autohotkey.html" class="nav-list-link">Autohotkey</a></li><li class="nav-list-item"><a href="/_docs/bash.html" class="nav-list-link">Bash Notes</a></li><li class="nav-list-item"><a href="/_docs/bittorrent.html" class="nav-list-link">BitTorrent Guide</a></li><li class="nav-list-item"><a href="/_docs/antigen.html" class="nav-list-link">Change antigen theme</a></li><li class="nav-list-item"><a href="/_docs/linux-desktop-environment.html" class="nav-list-link">Desktop environments in linux</a></li><li class="nav-list-item"><a href="/_docs/docker.html" class="nav-list-link">Docker</a></li><li class="nav-list-item"><a href="/_docs/dotfiles.html" class="nav-list-link">Dotfiles</a></li><li class="nav-list-item"><a href="/_docs/firewall.html" class="nav-list-link">Fortigate Firewall configuration</a></li><li class="nav-list-item"><a href="/_docs/general_networking.html" class="nav-list-link">General networking concepts</a></li><li class="nav-list-item"><a href="/_docs/git.html" class="nav-list-link">Git info</a></li><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/_docs/home-net.html" class="nav-list-link">Home network setup</a></li><li class="nav-list-item"><a href="/_docs/httpd.html" class="nav-list-link">Httpd configuration for linux</a></li><li class="nav-list-item"><a href="/_docs/i3.html" class="nav-list-link">I3 notes</a></li><li class="nav-list-item"><a href="/_docs/protonvpn.html" class="nav-list-link">Kill switch configuration</a></li><li class="nav-list-item"><a href="/_docs/linux_networking.html" class="nav-list-link">Linux Networking</a></li><li class="nav-list-item"><a href="/_docs/linux_file_permissions.html" class="nav-list-link">Linux file permissions</a></li><li class="nav-list-item"><a href="/_docs/network-manager.html" class="nav-list-link">Network Manager</a></li><li class="nav-list-item"><a href="/_docs/storage.html" class="nav-list-link">Network Storage</a></li><li class="nav-list-item"><a href="/_docs/networking.html" class="nav-list-link">Networking</a></li><li class="nav-list-item"><a href="/_docs/rhcsa.html" class="nav-list-link">Notes about RHCSA</a></li><li class="nav-list-item"><a href="/_docs/rpm.html" class="nav-list-link">Notes for RPM packages</a></li><li class="nav-list-item"><a href="/_docs/shoot.html" class="nav-list-link">Notes for advanced troubleshooting on RHEL</a></li><li class="nav-list-item"><a href="/_docs/keyboard.html" class="nav-list-link">Notes for trying to fix my keyboard</a></li><li class="nav-list-item"><a href="/_docs/proxmox.html" class="nav-list-link">Proxmox notes</a></li><li class="nav-list-item"><a href="/_docs/random.html" class="nav-list-link">Random notes for random things</a></li><li class="nav-list-item"><a href="/_docs/systemd.html" class="nav-list-link">Systemd</a></li><li class="nav-list-item"><a href="/_docs/tmux.html" class="nav-list-link">Tmux notes</a></li><li class="nav-list-item"><a href="/_docs/troubleshooting.html" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item"><a href="/_docs/tutorial_ideas.html" class="nav-list-link">Tutorial ideas for the youtube channel ( Full Duplex )</a></li><li class="nav-list-item"><a href="/_docs/vim.html" class="nav-list-link">Vim</a></li><li class="nav-list-item"><a href="/_docs/wants.html" class="nav-list-link">Wants</a></li><li class="nav-list-item"><a href="/_docs/windows.html" class="nav-list-link">Windows 10 notes WORK IN PROGRESS</a></li><li class="nav-list-item"><a href="/_docs/lvm.html" class="nav-list-link">notes about setting up lvm’s</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Buhfur's Wiki" aria-label="Search Buhfur's Wiki" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/just-the-docs/just-the-docs-template" class="site-button" > Template Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="notes-about-rhcsa"> <a href="#notes-about-rhcsa" class="anchor-heading" aria-labelledby="notes-about-rhcsa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes about RHCSA </h1> <h1 id="mananging-disks"> <a href="#mananging-disks" class="anchor-heading" aria-labelledby="mananging-disks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mananging disks </h1> <p>In this chapter , which I accidentally deleted by accident….fucking fat fingered my vim keybinds. Anywho… This is how you can manage disks on RHEL 9 !</p> <h1 id="step-one--finding-out-which-type-of-disk-parition-you-would-like-to-use"> <a href="#step-one--finding-out-which-type-of-disk-parition-you-would-like-to-use" class="anchor-heading" aria-labelledby="step-one--finding-out-which-type-of-disk-parition-you-would-like-to-use"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step one : Finding out which type of disk parition you would like to use </h1> <p>There’s two types of partitions you can make , the first being an MBR partition table.</p> <h2 id="mbr"> <a href="#mbr" class="anchor-heading" aria-labelledby="mbr"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MBR </h2> <p>MBR stands for Master Boot Record. It’s an old partitioning scheme from the 80’s which was meant to be read by your BIOS and loaded. This would allow you to actually boot your computer ! Withtin the Master Boot Record is a bootloader and a partition table. The bootloader for your computer by the way is the first 512 bytes of code that loads your OS( kernel ) into memory.</p> <p>You can create an MBR partitioning table by using fdisk. Run the command and select your disk</p> <p><strong>Example</strong></p> <p><code class="language-plaintext highlighter-rouge">$ fdisk /dev/sdx</code></p> <p>Side note : replace /dev/sdx with the name of your device</p> <p>in the options , select “p” for primary partition , use the default first sector , enter +1G for a one gibibyte partition</p> <p>You can change the type of partition by using the “t” option , by default the parititon type is set to Linux</p> <p>Once you are done , write your changes to disk with “w”.</p> <p>You can add extensible partitions which can contain logical partitions which can then be used to create filesystems on them. You cannot create a filesystem on an extensible partition on it’s own !</p> <p>To do this do the following :</p> <p>Use the “n” option to create a new partition.</p> <p>Then use the “e” option to create an extensible partition.</p> <h1 id="advanced-troubleshooting"> <a href="#advanced-troubleshooting" class="anchor-heading" aria-labelledby="advanced-troubleshooting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced troubleshooting </h1> <p>Here below I will put some notes while studying the following chapters to see if I retain any info I jot down here.</p> <p>I’m going to edit the grub2 config to increase the timeout so I can access it for longer periods of time.</p> <p>I’ve opened up another vm for learning about troubleshooting grub 2. You can modify some of the options during boot. Press ‘e’ to view the command line args that will be passed to your system at boot.</p> <p>Here are some options you can add to the command args and what they do:</p> <p>rd.break = stops boot procedure in the initramfs stage. This also means that the root filesystem is not mounted yet.</p> <p>init=/bin/sh or init=/bin/bash -&gt; specifies that the shell should be started after loading the kernel and initd. Provides earliest possible access to a running system. Only the root fs is mounted and it’s mounted as read-only</p> <h1 id="rescue-disk"> <a href="#rescue-disk" class="anchor-heading" aria-labelledby="rescue-disk"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rescue disk </h1> <p>If you are unable to boot from disk , you will more than likely see a blinking cursor. If not , regardless you should be able to use a rescue disk. The rescue disk is apart of the installation disk that comes with RHEL.</p> <p>If you can’t boot from GRUB , try the “Boot from a Local Drive” option which allows you to boot your machine using a bootloader that is installed to disk</p> <p>When using the Rescue a Red Hat Entrpriese Linux system , the distro should detect your other installation of RHEL. From there you will be able to access the filesystem your distro is installed on /mnt/sysimage.</p> <p>from there you can chroot to the filesystem in /mnt/sysimage</p> <p><code class="language-plaintext highlighter-rouge">chroot /mnt/sysimage</code></p> <p>Once you are in the root directory of the rescue disk , you can re-install grub2 if you need to. To do this run the following commands below</p> <p><code class="language-plaintext highlighter-rouge">grub2-install /dev/sdx</code></p> <p>If you’re initramfs is broken , you can use dracut to fix it. This command creates a new initramfs for the currently loaded kernel.</p> <p>config files for dracuc are stored in /etc/dracut.conf.d</p> <p>You can tell if the initramfs is messed up since the root filesystem will never be mounted. Nor will you see any systemd units started. To fix it using dracut</p> <p>just run the following command:</p> <p><code class="language-plaintext highlighter-rouge">dracut --force </code></p> <p>If there’s something wrong with the fstab file and you need to access the filesystem( in the event you can’t for some reason ) you can use the command below to remount the root filesystem</p> <p><code class="language-plaintext highlighter-rouge">mount -o remount,rw /</code></p> <p>This remounts the root fs with the ‘rw’ and the ‘remount’ mount options.</p> <h1 id="resetting--forgetting-the-root-password"> <a href="#resetting--forgetting-the-root-password" class="anchor-heading" aria-labelledby="resetting--forgetting-the-root-password"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resetting / forgetting the root password </h1> <ol> <li> <p>Start system with init=/bin/bash arg in grub boot menu command line.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">mount -o remount,rw / </code></p> </li> <li> <p><code class="language-plaintext highlighter-rouge">passwd root</code></p> </li> <li> <p><code class="language-plaintext highlighter-rouge">exec /usr/lib/systemd/systemd</code></p> </li> </ol> <p>And that is how you can change the root password</p> <p>IF systemd is not started , you can use a similar command to step 4</p> <p><code class="language-plaintext highlighter-rouge">exec /usr/lib/sytemd/system</code></p> <h1 id="bash-scripting"> <a href="#bash-scripting" class="anchor-heading" aria-labelledby="bash-scripting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bash scripting </h1> <p>Arguments used in bash scripts can be referenced by a $1-9 character</p> <p>For example , if you have a script something.bash name1 name2</p> <p>Name1 would be $1 and name2 would be $2</p> <p>”$#” represents the number of arguments you have entered “$@” refers to all arguments used when starting the script.</p> <p>You can use the “read” command to query the user for input</p> <p>To add a timestamp to something , you can use the following command and add it to a variable</p> <p>TODAY=$(date +%d-%m-%y)</p> <p>Most of the syntax for bash scripting is straight forward , with the added exception of the until statement , which acts like a do while loop</p> <p>Note : don’t use spaces in between the ‘=’ sign and the declaration of the variable Also put spaces in between conditional brackets</p> <h2 id="debugging-bash-scripts"> <a href="#debugging-bash-scripts" class="anchor-heading" aria-labelledby="debugging-bash-scripts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Debugging bash scripts </h2> <p>To debug a script and find out what it’s doing , you can run the <code class="language-plaintext highlighter-rouge">bash -x script.bash</code> command which will tell you what code is being run. And any errors that might occur during runtime.</p> <h1 id="configuring-ssh"> <a href="#configuring-ssh" class="anchor-heading" aria-labelledby="configuring-ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring SSH </h1> <p>dictionary attacks are commonly used to break into ssh servers , from what i’ve seen on my machine they typically use usernames and passwords that might be setup by default on the server.</p> <p>These are things you can do to harden your ssh server</p> <ul> <li>Disable root login ( disabled by default)</li> <li>Disable password login ( not disabled by default )</li> <li>Configure a non-default port for SSH ( already done for most of my servers )</li> <li>Allow specific users only to login to ssh ( I haven’t done this yet )</li> </ul> <p>To configure these things , you can make all configuration changes in the /etc/ssh/sshd_config file. This config file is the default config used for an ssh server.</p> <h2 id="config-option-for-disallowing-the-root-user-to-login-to-ssh"> <a href="#config-option-for-disallowing-the-root-user-to-login-to-ssh" class="anchor-heading" aria-labelledby="config-option-for-disallowing-the-root-user-to-login-to-ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Config option for disallowing the root user to login to ssh </h2> <p>PermitRootLogin prohibit-password</p> <p>This only allows the root user to login if they have a valid pub/private key pair</p> <h2 id="changing-default-ssh-port"> <a href="#changing-default-ssh-port" class="anchor-heading" aria-labelledby="changing-default-ssh-port"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Changing default ssh port </h2> <p>Edit config file in /etc/ssh/sshd_config</p> <p>Add port to SELinux label <code class="language-plaintext highlighter-rouge">semanage port -a -t ssh_port_t -p tcp &lt;PORTNUMBER&gt;</code></p> <p>Allow port through firewall-cmd</p> <p><code class="language-plaintext highlighter-rouge">firewall-cmd --add-port=&lt;port&gt;/tcp --permanent </code></p> <p>Then reload the configuration for the service</p> <p><code class="language-plaintext highlighter-rouge">systemctl reload sshd</code></p> <p>Then reload the firewall-cmd config</p> <p><code class="language-plaintext highlighter-rouge">firewall-cmd --reload</code></p> <p>You shoulden’t really use the MaxAuthTries option since it’s suseptible to ddos attacks. When this option is enabled it locks out the specified user trying to login. So someone could just try to login as that usera bunch to lock up the account. It’s still good for monitoring security events as this option starts logging the failed attempts.</p> <p>Logs are written to the AUTHPRIV syslog utility. By default it writes the logs to /var/log/secure</p> <h2 id="restriciting-which-users-can-login-to-your-ssh-server"> <a href="#restriciting-which-users-can-login-to-your-ssh-server" class="anchor-heading" aria-labelledby="restriciting-which-users-can-login-to-your-ssh-server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Restriciting which users can login to your ssh server </h2> <p>You can enable access to your server by the usernames of the users. To do this , you must add the AllowUsers field in the /etc/ssh/sshd_config file</p> <h2 id="other-useful-sshd-options"> <a href="#other-useful-sshd-options" class="anchor-heading" aria-labelledby="other-useful-sshd-options"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Other useful sshd options </h2> <p>UseDNS -&gt; Very inefficient if other users connections are slow , turn off for performance. This option verifies remote hostname is same as remote address</p> <p>MaxSessions -&gt; specifies max number of sessions from the same remote IP. If you have users connecting to the server with multiple sessions it’s a good practice to increase the amount of max sessions.</p> <p>TCPKeepAlive -&gt; ensures clients that are unavailable are released ClientALiveInterval -&gt; time before the server sends a packet to the client when no activity is detected.</p> <p>ClientAliveCountMax -&gt; specifies how many of these packets are sent. if set to 30 and ClientAliveCountMax is set to 10 , connections are kept alive for about 5 minutes.</p> <p>The two options above can only be used for the server side of ssh connections. You can try using two options for clients which try to do the same thing</p> <p>ServerAliveInterval &amp; ServerAliveCountMax</p> <p>modify the ~/.ssh/config for local users</p> <p>I’d also like to note other options that are used with ssh as well</p> <p>HostBasedAuthentication -&gt; Allows only users who’s keys are already present in /etc/ssh/ssh_known_hosts. To enable this , add the key in the users .ssh/authorized_keys and copy it over to the directory mentioned previously.</p> <h2 id="key-locations"> <a href="#key-locations" class="anchor-heading" aria-labelledby="key-locations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key locations </h2> <p>Client/Sever public/private keys -&gt; /etc/ssh</p> <p>Clients pub pri key -&gt; /home/user/.ssh</p> <h2 id="key-pair-authentication"> <a href="#key-pair-authentication" class="anchor-heading" aria-labelledby="key-pair-authentication"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key pair authentication </h2> <p>Generate public / private key <code class="language-plaintext highlighter-rouge">ssh-keygen</code></p> <p>Then copy the key over to your server , make sure password auth is enabled <code class="language-plaintext highlighter-rouge">ssh-copy-id -p 1234 user@192.1.1.1</code></p> <p>If you set a passphrase , cache the passphrase to save time</p> <p><code class="language-plaintext highlighter-rouge">ssh-agent /bin/bash</code></p> <p><code class="language-plaintext highlighter-rouge">ssh-add</code></p> <p>You can set a passphrase for the private key which is in most cases more secure, however it is inconveinient for the user as they will have to enter this key everytime they attempt to connect to the server. However you can cache the key for a short amount of time using the ssh-agent and ssh-add commands. To do so , see below</p> <h1 id="selinux"> <a href="#selinux" class="anchor-heading" aria-labelledby="selinux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SELinux </h1> <p>SELinux prevents system calls from being executed unless allowed. In selinux you have policies which contain rules that specify what source domain is allowed to access which target domain You have to be root user to use any of the commands</p> <p>Check all active ports on SELinux</p> <p><code class="language-plaintext highlighter-rouge">semange port -l</code></p> <p>The names listed for these ports are labels , for example the label for the SSH port is ssh_port_t. The label relates to the service and port used.</p> <p>If you want to change the port for an existing label , you must modify the port listed on the label.</p> <p>Source domains can be a port or a process.</p> <p>Target domains could be a file , directory , or network port</p> <p>labels define access rules also called context labels</p> <p>SELinux has two modes, enforcing mode , and permissive mode.</p> <p>IN enforcing mode, SELinux is fully operational and enforces all rules in the polic</p> <p>in permissive mode, activity is logged however no access is blocked to any services so this mode isn’t really secure</p> <p>Logging messages are written to /var/log/audit/audit.log</p> <p>you can change the mode for selinux in /etc/sysconfig/selinux</p> <p>On RHEL , by default the setting is set to enforcing</p> <p>To put selinux in disabled mode on RHEL 9 , you need to change the kernel boot argument to selinux=0 , you can also set permissive mode in the kernel boot options as well with enforcing=0</p> <p>You can use setenforce to check what mode selinux is in , you can switch between the two modes by specifying a number that relates to the mode</p> <p>Set permissive mode</p> <p><code class="language-plaintext highlighter-rouge">setenforce 0 </code></p> <p>Set enforce mode</p> <p><code class="language-plaintext highlighter-rouge">setenforce 1</code></p> <p>This only changes the mode temporarily , to keep the changes you will need to write it to /etc/sysconfig/selinux</p> <p>You can also check the status of selinux with the sestatus command <code class="language-plaintext highlighter-rouge">sestatus -v </code></p> <p>If anyone tells you you need to disable selinux for an application , they’re wrong as a policy can be added for any application.</p> <p>you can use <code class="language-plaintext highlighter-rouge">sepolicy generate</code> to generate a new policy for an application</p> <h2 id="context-labels"> <a href="#context-labels" class="anchor-heading" aria-labelledby="context-labels"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Context labels </h2> <p>Files and directories Ports Processes Users</p> <p>Context labels define the nature of the object. Rules are created to match context labels of source objects ( or source domains ) to labels of target objects ( target domains ) <br /> So setting up these labels correctly is very important as mismatching context labels can cause alot of issues with selinux.</p> <p>Make sure you know about context types as they are important for the exam</p> <h1 id="configuring-a-firewall"> <a href="#configuring-a-firewall" class="anchor-heading" aria-labelledby="configuring-a-firewall"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring a firewall </h1> <p>firewall-cmd uses the netfilter subsystem , it allows kernel modules to inspect incoming , outgoing , or forwarded packets and either allow the packet or block it.</p> <p>iptables used to be the default firewall , however it has since been replaced by nftables.</p> <p>You can use the <code class="language-plaintext highlighter-rouge">nft</code> command to rules directly to nftables</p> <p>Firewalld is a system service that can configure firewall rules by using different interfaces.</p> <p>Apps can request ports to be opened by using the DBus messaging system. Without requireing any action from the sys admin.</p> <p>This allows apps to address the firewall from user space.</p> <p>firewall-cmd manages the firewalld system service</p> <p><strong>Understanding Firewalld Zones</strong></p> <p>a <strong>zone</strong> is a collection of rules that are applied to incoming packets matching a specific source address or network interface</p> <p>Firewalld applies to incoming packets by default , outgoing packets must be configured</p> <p>Zones are useful for servers that have multiple interfaces. Multiple zones allow you to set a specific set of rules for each interface.</p> <p>With servers with only one interface, you may only need 1 zone.</p> <p>This zone is already set by default , and if no zone is available , packets are handled through the default zone.</p> <p><strong>Firewalld default zones</strong></p> <h3 id="block"> <a href="#block" class="anchor-heading" aria-labelledby="block"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Block </h3> <p>incoming connections are rejected with an “icmp-host-prohibited”. Only connections that were initiated on this system are allowed</p> <h3 id="dmz"> <a href="#dmz" class="anchor-heading" aria-labelledby="dmz"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dmz </h3> <p>For use on computers in the demilitarized zone , only selected incoming connections are accepted, limited access to the internal network is allowed.</p> <h3 id="drop"> <a href="#drop" class="anchor-heading" aria-labelledby="drop"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Drop </h3> <p>Any incoming packets are dropped and there is no reply.</p> <h3 id="external"> <a href="#external" class="anchor-heading" aria-labelledby="external"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> External </h3> <p>For use on external networks with NAT enabled, used on routers. Only selected incoming packets are acccepted.</p> <h3 id="home"> <a href="#home" class="anchor-heading" aria-labelledby="home"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Home </h3> <p>For use with home networks , computers on the same network are truested and only selected incoming connections are accepted.</p> <h3 id="internal"> <a href="#internal" class="anchor-heading" aria-labelledby="internal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Internal </h3> <p>Most computers on the same network are trusted , only selected incoming connections are accepted.</p> <h3 id="public"> <a href="#public" class="anchor-heading" aria-labelledby="public"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Public </h3> <p>Other computers in the same network are not trusted, limited connections are accepted. Used as the default zone for newly created network interfaces.</p> <h3 id="trusted"> <a href="#trusted" class="anchor-heading" aria-labelledby="trusted"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Trusted </h3> <p>All network connections are accepted</p> <h3 id="work"> <a href="#work" class="anchor-heading" aria-labelledby="work"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Work </h3> <p>Most computers on the same network are trusted, only selected incoming connections are accepted.</p><hr /> <p><strong>Understanding Firewalld Services</strong></p> <p>Not the same as a service in systemd.</p> <p>A Firewalld service specifies what exactly should be accepted as incoming and outgoing traffic in the firewall.</p> <p>This typically includes ports to be opened and kernel modules that should be loaded</p> <p>XML files define the service. And they can be found in /usr/lib/firewalld/services</p> <p>By looking at the service file for git.xml , you can see the port being defined and the protocol used for the service.</p> <p>You can also use the <code class="language-plaintext highlighter-rouge">firewall-cmd --get-services</code> command to see what services are available</p> <p>Services are added to zones</p> <p>To add your own services , you can put the XML files in the /etc/firewalld/services directory. They will be automatically added once the firewalld service is restarted.</p> <p><strong>Working with Firewalld</strong></p> <p>Remember to commit changes to on-disk once you are finished</p> <p>On the exam , only use ports if no services contain the ports that you want to open.</p><hr /> <h1 id="nfs"> <a href="#nfs" class="anchor-heading" aria-labelledby="nfs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NFS </h1> <p>You should use NFS with an authentication service such as Lightweight Directory Access Protocol ( LDAP for short ) or kerberos</p> <p><strong>Setting up NFS</strong></p> <ol> <li>Create local directory you would like to share</li> <li>Edit the /etc/exports file to define NFS share</li> <li>Start NFS server</li> <li>Configure firewall to allow incoming NFS traffic</li> </ol> <p>If you encounter issues while mounting , keep in mind that NFSv4 may have issues with servers behind a firewall.</p> <p>Showmount relies on the portmapper service which uses random UDP ports to make a connection. Therefore if you have issues it may be due to the showmounts UDP port being blocked by the firewall. To circumvent this, you can simply perform a pseudo root mount on the</p> <p><strong>Mounting NFS Shares Through fstab</strong></p> <p>Add the following line :</p> <p><code class="language-plaintext highlighter-rouge">server1:/share /nfs/mount/point nfs sync 0 0 </code></p> <p><strong>Using Automount to mount Remote File Systems</strong></p> <p>autofs supports wildcard mounts which are not supported by systemd</p> <p>unlike mount , no root perms are required</p> <p>You define mount points and the directory of the secondary file</p> <p>Example :</p> <p><code class="language-plaintext highlighter-rouge">/nfsdata /etc/auto.nfsdata</code></p> <p>automount works completely in user space</p> <p>The configurations for the mount are defined in the /etc/auto.nfsdata file you created</p> <p>In the secondary file you created, you define the subdir that will be created using a relative file name. In the example in the book , they are using the subdir “files”</p> <p><code class="language-plaintext highlighter-rouge">files -rw server2:/nfsdata</code></p> <p>Instead of “server2” you can also put the IP of the nfs host</p> <p><strong>Configuring Automount for NFS</strong></p> <ol> <li>Install the autofs package</li> <li><code class="language-plaintext highlighter-rouge">showmount -e &lt;hostname/ip&gt;</code></li> <li>edit the /etc/auto.nfsdata</li> <li><code class="language-plaintext highlighter-rouge">systemctl enable --now autofs</code></li> <li>cd /nfsdata/files</li> <li>type mount</li> </ol> <p><strong>Using Wildcard in Automount</strong></p> <p>good for automounting home directories</p> <p>This allows you to store the home dir of a specific user on a central NFS server</p> <p>You can create a wildcard mount by specifying the mount in the secondary config file Example :</p> <p><code class="language-plaintext highlighter-rouge">* -rw server2:/users/&amp;</code></p> <p>the “*” represents the local mount point while the “\&amp;” matches the item on the remote server</p> <p>you could usually mount the /home directory in the config , but that would mean other users can access each others home directories.</p> <p>Example auto.master file</p> <p><code class="language-plaintext highlighter-rouge">/users /etc/auto.users</code></p> <p>Example /etc/auto.users file</p> <p><code class="language-plaintext highlighter-rouge">* -rw server2:/users/&amp;</code></p> <p>Example auto.home file which mounts each users home dir</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#/etc/auto.home
user1   server:/home/user1
user2   server:/home/user2
user3   server:/home/user3
</code></pre></div></div> <p>Exmaple auto.home mounting home dirs with wildcard mounts</p> <p><code class="language-plaintext highlighter-rouge">* server:/home/&amp;</code></p><hr /> <h1 id="configuring-time-services"> <a href="#configuring-time-services" class="anchor-heading" aria-labelledby="configuring-time-services"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring Time Services </h1> <p>During boot, the hardware clock or the real-time clock (RTC) is read , which resides in the computer hardware. The time it defines is the “hardware time”</p> <p>The time on the hardware clock on linux servers is set to Coordinated Universal Time (UTC)</p> <p>System time is maintained by the OS , independent of the hardware clock</p> <p>When system time is changed , it’s not synced with the harware clock.</p> <p>System time is kept in UTC . Apps convert system time into local time</p> <p>Local time is the actual timezone , Daylight Savings Time (DST ) is also considered so the accurate time will be displayed.</p> <p>Real Time Clock = same thing as a hardware clock</p> <p><strong>Using Network Time Protocol</strong></p> <p>Stratum defines the reliability of an NTP time source , the lower the stratum, the more reliable it is. Internet servers use stratum 1 or 2. You can use a higher stratum as a backup</p> <p>it’s good practice to set stratum 5 on a local time server with a reliable hardware clock and stratum 8 on a server that is not reliable</p> <p>the /etc/chrony.conf file is a config file with a standard list of NTP servers on the internet.</p> <p>All you need to do is switch on NTP</p> <p><code class="language-plaintext highlighter-rouge">timedatectl set-ntp 1</code></p> <p>On linux , time is calculated as an offset of epoch time , Epoch time is the numebr of seconds since January 1, 1970</p> <p>Timestamps in /var/log/audit/audit.log are in epoch time , not human time.</p> <p>To convert epoch time to human time , use the following command</p> <p>The epoch timestamp is in the “msg=audit” field in /var/log/audit/audit.log</p> <p><code class="language-plaintext highlighter-rouge">date --date '@1720893005</code></p> <p>There is a problem with epoch time however, on a 32-bit system , the number of seconds that can be counted in the field reserved for time notation will be exceeded in 2037. You can test this by attempting to set the time to 2050</p> <p>64-bit systems however can notate time far into the twenty second century</p> <p>You can also use <code class="language-plaintext highlighter-rouge">date</code> to show time in different formats</p> <p><strong>Show the current system day of month, month , and year</strong></p> <p><code class="language-plaintext highlighter-rouge">date +%d-%m-%y</code></p> <p><strong>Set the current time 3 minutes past 4 pm</strong></p> <p><code class="language-plaintext highlighter-rouge">date -s 16:03</code></p> <p><strong>Using hwclock</strong></p> <p><code class="language-plaintext highlighter-rouge">hwclock --systohc</code> - synchronizes curent system time to the hardware clock</p> <p><code class="language-plaintext highlighter-rouge">hwclock --hctosys</code> - synchronizes current hardware time to the system clock</p> <p><strong>Using timedatectl</strong></p> <p>timedatectl , when used without any arguments the command shows you detailed info about the current time and date , it also shows the time zone you are in.</p> <p><strong>timedatectl commands</strong></p> <p><code class="language-plaintext highlighter-rouge">status</code> - shows current time settings</p> <p><code class="language-plaintext highlighter-rouge">set-time TIME</code> - sets the current time</p> <p><code class="language-plaintext highlighter-rouge">set-timezone ZONE</code> - sets the current timezone</p> <p><code class="language-plaintext highlighter-rouge">list-timezone</code> - shows a list of all time zones</p> <p><code class="language-plaintext highlighter-rouge">set-local-rtc [0|1]</code> - controls whether the RTC ( hardware clock )</p> <p><code class="language-plaintext highlighter-rouge">set-ntp [0|1]</code> - Controls whether NTP is enabled</p> <p>timedatectl is used to switch on NTP time , it talks to the chronyd process</p> <p>Between linux servers , time is normally communicated in UTC to allow servers to use the same time settings</p> <p><strong>Setting the correct time zone</strong></p> <ol> <li> <p>Create a symbolic link to a file in the /usr/share/zoneinfo and name it /etc/localtime</p> </li> <li> <p>Use the <code class="language-plaintext highlighter-rouge">tzselect</code> utility</p> </li> <li> <p>use timedatectl</p> </li> </ol> <p><strong>Configuring Time Service Clients</strong></p> <p>by default , chrony is configured to get the right time from the internet. Servers from pool.ntp.org are used.</p> <p>you can add your own local time servers to be used in the /etc/chrony.conf file</p> <p><strong>Configuring local NTP time client</strong></p> <ol> <li>Comment out pool 2.rhel.pool.ntp.org</li> <li>include the line <code class="language-plaintext highlighter-rouge">allow 192.168.0.0/16</code> to allow access from all clients that use a local IP address starting with 192.168</li> <li>include the line <code class="language-plaintext highlighter-rouge">local stratum 8</code> to ensure your local time server will advertise itself with a stratum of 8</li> <li>restart the chronyd service</li> <li>add the ntp service to the firewall <code class="language-plaintext highlighter-rouge">firewall-cmd --add-service ntp --permanent</code> followed by <code class="language-plaintext highlighter-rouge">firewall-cmd --reload</code></li> <li>on the secondary server , add the hostname or IP of the NTP server to the clients config file.</li> <li>restart the chronyd service</li> <li>run <code class="language-plaintext highlighter-rouge">chronyc sources </code></li> </ol> <h1 id="containers"> <a href="#containers" class="anchor-heading" aria-labelledby="containers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Containers </h1> <p>Container images contain all dependencies to run an application.</p> <p>Container runs on top of a container engine , the container is run from a container image. These container images are found in a container registry.</p> <p>To run containers , you need an OS that includes a conatiner engine , docker was used initially but it has since been replaced by CRI-o</p> <p>There are three tools you can use to manage containers</p> <p>podman - used to start, stop , and manage containers</p> <p>buildah - tool that helps you create custom images</p> <p>skopeo - tool used for managing and testing container images</p> <p>Containers are not always pure linux , although they do depend on a few features offered by the linux kernel</p> <p>Namely :</p> <ul> <li> <p>Namespaces for isolation between processes</p> </li> <li> <p>Control groups for resource management</p> </li> <li> <p>SELinux for security</p> </li> </ul> <p>A namespace provides isolation for system resources , for example chroot jails, which presents the contents of a directory as it it is the root directory of your system. So process running in the chroot jail can’t see anything but the contents of that directory. This stops the process from accessing other parts of the OS.</p> <p>chroot jails still exist , except now they are leveraged and part of what’s called the <strong>mount namespace</strong></p> <p><strong>Overview of namespaces</strong></p> <p>Mount - equivalent to chroot namespace , contents of a directory are presented in such a way that no other directories can be accessed</p> <p>Process - makes sure that processes running the this namespace cannot reach</p> <p>Network - Network namespaces can be compared to VLAN’s. Nodes connected to a specific network namespace cannot see what is happening in other network namespaces. Contact to other Network namespaces is only possible through routers.</p> <p>User - used to separate user ID’s and group ID’s between namespaces. user accounts are specific to each namespace.</p> <p>Interprocess Communication (ipc) - what processes use to connect to one another, namespace ensures only connections can be made to processes in the same namespace.</p> <p>Network namespace is not enabled by default</p> <p>Control groups or Cgroups are a kernel feature that enables resource access limitation. By default , there is no restriction to the amount of memory of number of CPU cycles a process can access. These make it possible to limit the resources a container can use.</p> <p>With SELinux , a context label is added to ensure that containers can access only the resources they need access to and nothing else.</p> <p><strong>Containers on RHEL 9</strong></p> <p>Advantages over Docker with CRI-o:</p> <ul> <li> <p>containers can be started by ordinary users that do not need elevated privileges , called a rootless container.</p> </li> <li> <p>When users start containers , they run in a user namespace where they are strictly isolated and not accesssible to other users.</p> </li> <li> <p>Podman containers run on top of the lightwieght CRI-o container runtime , without needing any daemon to do work.</p> </li> <li> <p>rootless containers do not have an IP address.As assigning an IP requires root perms</p> </li> <li> <p>rootless containers cannot access components on the host OS that require root access</p> </li> <li> <p>rootless containers can only bind to a non-privileged TCP or UDP port.</p> </li> <li> <p>if rootless containers need access to host-based storage , the user who runs the container must be the owner of the directory that provides the storage.</p> </li> </ul> <p><strong>Container Orchestration</strong></p> <p>When a host goes down , the containers will go down , however there are additional features to fix this</p> <ul> <li> <p>Easy connection to a range of external storage types</p> </li> <li> <p>Secure access to sensitive data</p> </li> <li> <p>Decoupling , site specific data is strictly separated from the code inside the container environment</p> </li> <li> <p>Scalability , such that when workload increases , additional instances can easillybe added</p> </li> <li> <p>Availability , ensuring that the outage of a container host doesn’t result in container unavailability</p> </li> </ul> <p>To implement these features , Kuberenetes was developed , redhat has it’s own kubernetes distro called OpenShift. Which can build a scalable, flexible , reliable infra based on containers.</p> <p><strong>Running Containers</strong></p> <p>Install tools required for using containers</p> <p><code class="language-plaintext highlighter-rouge">sudo dnf install container-tools</code></p> <p>You can run your first container with</p> <p><code class="language-plaintext highlighter-rouge">podman run</code></p> <p>You supply the name of the container image you would like to run.</p> <p>You can specify the registry with <code class="language-plaintext highlighter-rouge">podman run</code> as well if you would like to select a specific one</p> <p>/bin/sh will usually be available in most container images</p> <p>Use Ctrl-P or Ctrl-Q to detach</p> <p>non-root container files are copied to ~/.local/share/containers/sotrage</p> <p>Average size for each container is about 60 MB</p> <p>container is a running instance of an image , while running a writable layer is added to store changes made to the container.</p> <p>Container images are created in the Docker format.</p> <p><strong>Using Registries</strong></p> <p>Continer registries are defined in the /etc/containers/registries.conf file</p> <p>Users hwo run a rootless container can create a file ~/.config/containers/registries.conf</p> <p>settings in the user-specific file will override settings in the generic file</p> <p>in registries.conf , all container registries are listed as unqualified-seach-registries , this is due to redhat requiring the complete image name and registry to avoid ambiguity.</p> <p>So instead of using :</p> <p><code class="language-plaintext highlighter-rouge">podman run -d nginx</code></p> <p>You use this :</p> <p><code class="language-plaintext highlighter-rouge">podman run -d docker.io/library/nginx</code></p> <p><strong>Finding Images</strong></p> <p>To find available images , you can use the <code class="language-plaintext highlighter-rouge">podman search</code> command j</p> <p>If you are trying to search for containers in Redhat registries , you will need to login using the <code class="language-plaintext highlighter-rouge">podman login</code> command with the registry name following the prior commands.</p> <p>You can filter the results with <code class="language-plaintext highlighter-rouge">podman search</code> by using the <code class="language-plaintext highlighter-rouge">--filter</code> args</p> <p>Example:</p> <p><code class="language-plaintext highlighter-rouge">podman search --filter official=true alpine</code></p> <p><code class="language-plaintext highlighter-rouge">podman search --filter stars=5 alpine</code></p> <p>You can also search for the UBI in the Redhat registries for an image</p> <p>UBI = Universal Base Image</p> <p><strong>Inspecting Images</strong></p> <p>You can inspect images using the spokeo tool</p> <p><code class="language-plaintext highlighter-rouge">skopeo inspect </code></p> <p>Inspection happens from the registry without any need to pull the image</p> <p>You can inspect images on your local system by using the podman command</p> <p><code class="language-plaintext highlighter-rouge">podman inspect</code></p> <p>You can remove images by using the <code class="language-plaintext highlighter-rouge">podman rmi</code> command.</p> <p>You must stop all instances of a container image in order to remove it.</p> <p><strong>Building Images from a Containerfile</strong></p> <p>Conatinerfile is the same as a Dockerfile</p> <p>To build container images , you can use the <code class="language-plaintext highlighter-rouge">podman build</code> command</p> <p>Containerfile example :</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FROM registry.access.redhat.com/ubi8/ubi:latest
RUN dnf install nmap
CMD  ["/usr/sbin/nmap", "-sn", "192.168.29.0/24"]

</code></pre></div></div> <p>THe FROM keyword identifies the base image to use</p> <p>RUN keyword specifies commands to run in the base image while building the custom image</p> <p>The CMD command specifies the default command that should be started by the custom image</p> <p>Alpine is a good base image to use as it is lightweight.</p> <p><strong>Manging Container Status</strong></p> <p><code class="language-plaintext highlighter-rouge">podman stop</code> - sends SIGTERM signal to the container , if no results after 10 seconds , the SIGKILL signal is sent.</p> <p><code class="language-plaintext highlighter-rouge">podman kill</code> - immediately sends the SIGKILL command</p> <p><code class="language-plaintext highlighter-rouge">podman restart</code> - restarts container</p> <p><code class="language-plaintext highlighter-rouge">podman rm</code> - removes container files written to the writable layer</p> <p><code class="language-plaintext highlighter-rouge">podman run --rm</code> - runs the container and deletes container files automatically</p> <p><strong>Running Commands in a Container</strong></p> <p>You can run commands in the container using the <code class="language-plaintext highlighter-rouge">podman exec</code> command</p> <p>Command output is written to STDOUT</p> <p><strong>Open port for container</strong></p> <p><code class="language-plaintext highlighter-rouge">podman run --name &lt;container&gt; -d -p &lt;hostport&gt;:&lt;forwardport&gt; &lt;processname&gt;</code></p> <p>Then add the port to your firewall and reload the config</p> <p><strong>Start container with env variables</strong></p> <p>Mariadb example:</p> <p><code class="language-plaintext highlighter-rouge">podman run -d -e MYSQL_ROOT_PASSWORD=password -e MYSQL_USER=anna </code></p> <p><strong>Set persistant storage for container</strong></p> <p><code class="language-plaintext highlighter-rouge">semanage fcontext -a -t container_file_t "hostdir(/.*)?"; restorecon</code></p> <p>To do so automatically :</p> <p><code class="language-plaintext highlighter-rouge">-v host_dir:container_dir</code></p> <p>If root container or if user is owner of the container</p> <p><code class="language-plaintext highlighter-rouge">-v host_dir:container_dir:Z</code></p> <p><strong>Run commands inside container namespace</strong></p> <p><code class="language-plaintext highlighter-rouge">podman unshare</code></p> <p><strong>Map root user UID with current UID</strong></p> <p><code class="language-plaintext highlighter-rouge">podman unshare cat /proc/self/uid_map</code></p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
